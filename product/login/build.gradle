apply from: "$rootDir/gradle/spring-boot-app.gradle"
apply from: "$rootDir/gradle/spring-boot-jdbc.gradle"
apply from: "$rootDir/gradle/spring-boot-web.gradle"
apply from: "$projectDir/src/webapp/build.gradle"

description = 'The Codekvast Login server'
applicationName = 'codekvast-login'
archivesBaseName = 'codekvast-login'
version = codekvastVersion
group = 'crisp'
mainClassName = 'io.codekvast.login.CodekvastLoginApplication'

dependencies {
    compile project(":product:common")

    compile 'org.springframework.boot:spring-boot-starter-security'
    compile 'org.springframework.security.oauth:spring-security-oauth2'

    compile 'io.jsonwebtoken:jjwt:0.9.0'

    runtime project(':product:db-migration')
}

run {
    group "Backend Development"
    dependsOn startMariadb

    jvmArgs = [
        '-ea',
    ]

    args = [
        "--logging.file=$buildDir/log/${applicationName}.log",
        "--spring.profiles.active=dev-oauth-secrets,webpack-dev-server"
    ]
}

bootRun {
    group "Backend Development"
    dependsOn startMariadb

    jvmArgs = run.jvmArgs
    args = run.args
}

//--- Packaging ------------------------------------------------------------------------------------------------------------------
springBoot {
    executable = true
    embeddedLaunchScriptProperties = [
        'initInfoProvides'        : applicationName,
        'initInfoShortDescription': 'Codekvast Login',
        'initInfoDescription'     : 'Codekvast Login handles logins',
    ]
    excludeDevtools = true
}
